var Textarea=function(){function l(a){void 0===a&&(a={});for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b],e;for(e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}function m(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"};return a&&a.replace(/[&<>"]/g,function(a){return b[a]})}var k="padding-top padding-right padding-bottom padding-left border-top-width border-right-width border-bottom-width border-left-width font-weight font-size font-family font-size-adjust line-height letter-spacing word-spacing text-decoration text-transform text-align text-indent direction white-space word-wrap box-sizing".split(" "),
f=function(a,b){this.opts=l({},{tab:"  ",buffer:0,autodedent:!1},b);this.el=a;if(this.opts.autodedent){var c=this.el,d;d=this.el.value;for(var e=[],g=null,f=/(^|\n)(\s+)/g;null!==(g=f.exec(d));)e.push(parseInt(g[2].length,10));e=Math.min.apply(null,e);d=d.replace(new RegExp("(^|\n)\\s{"+e+"}","g"),"$1");c.value=d}this.initTabListener();this.initReturnListener();this.initResizeToFit();this.opts.poll&&this.initValuePoll(this.opts.poll)};f.prototype.initTabListener=function(){var a=this.opts.tab;this.el.addEventListener("keydown",
function(b){if(9==b.which){b.preventDefault();b=b.shiftKey;var c=this.selectionStart,d=this.selectionEnd,e=d-c,g=this.value.lastIndexOf("\n",c-1),f=this.value.indexOf("\n",d-(0===e?0:1));-1==g&&(g=0);-1==f&&(f=this.value.length);var d=this.value.slice(0,g),h=this.value.slice(g,f),f=this.value.slice(f),h=b?h.replace(new RegExp(0===g?"(^|\n)"+a:"(\n)"+a,"g"),"$1"):h.replace(new RegExp(0===g?"(^|\n)":"(\n)","g"),"$1"+a);this.value=d+h+f;0===e?(b=c+(b?-a.length:a.length),this.setSelectionRange(b,b)):
this.setSelectionRange(0===g?0:g+1,g+h.length)}},!1)};f.prototype.initReturnListener=function(){this.el.addEventListener("keydown",function(a){if(13==a.which){var b;var c=this.value;b=this.selectionStart;if(a.metaKey){var d=c.indexOf("\n",b-1);-1<d&&(b=d)}var d=c.lastIndexOf("\n",b-1)+1,e=c.slice(d).match(/^[ \t]+/);e?(c=this.value.slice(0,b),d=this.value.slice(b),e="\n"+e[0],this.value=c+e+d,b+=e.length,this.setSelectionRange(b,b),b=!0):b=void 0;b&&a.preventDefault()}},!1)};f.prototype.initValuePoll=
function(a){var b=this,c=this.el.value.length;setInterval(function(){var a=b.el.value.length;a!=c&&(b.resizeToFit(),c=a)},a)};f.prototype.initResizeToFit=function(){this.el.style.horizontal=""===this.el.style.width?"horizontal":"none";var a=document.createElement("div");a.style.position="absolute";a.style.visibility="hidden";a.style.display="block";this.shadow=a;this.el.parentNode.insertBefore(this.shadow,this.el);for(var a=this.shadow,b=window.getComputedStyle(this.el),c=0;c<k.length;c++){var d=
k[c];a.style[d]=b[d]}a=this.resizeToFit.bind(this);window.addEventListener("resize",a,!1);document.addEventListener("readystatechange",a,!1);this.el.addEventListener("blur",a,!1);this.el.addEventListener("keyup",a,!1);this.el.addEventListener("change",a,!1);this.el.addEventListener("cut",a,!1);this.el.addEventListener("paste",a,!1);this.el.addEventListener("input",a,!1);this.resizeToFit()};f.prototype.resizeToFit=function(){if(this.shadow.clientWidth!=this.el.clientWidth){var a=window.getComputedStyle(this.el);
this.shadow.style.width=a.width}a=m(this.el.value);this.shadow.innerHTML=a+"&nbsp;";var b=window.getComputedStyle(this.el),a=parseInt(b["min-height"],10),b=parseInt(b["max-height"],10),c=window.getComputedStyle(this.shadow);!isNaN(b)&&c.height>b?(this.el.style.overflow="auto",this.el.style.height=""):!isNaN(a)&&c.height<a?(this.el.style.overflow="auto",this.el.style.height=""):c.height!=this.el.style.height&&(this.el.style.overflow="hidden",this.el.style.height=c.height)};f.enhance=function(a,b){return new f(a,
b)};return f}();
